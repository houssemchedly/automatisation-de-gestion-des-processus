<div class="layout-wrapper">


  <div class="main-content">
    <div class="project-detail-container">
      <!-- Header Section -->
      <div class="detail-header">
        <div class="header-left">
          <button
            type="button"
            class="back-btn p-button-text p-button-plain"
            pButton
            icon="pi pi-arrow-left"
            (click)="goBack()"
            pTooltip="Go Back">
          </button>
          <h1 class="project-title">{{ project?.title || 'Project Details' }}</h1>
        </div>

        <div class="header-actions">
          <button
            type="button"
            pButton
            [label]="isEditMode ? 'Cancel' : 'Edit'"
            [icon]="isEditMode ? 'pi pi-times' : 'pi pi-pencil'"
            class="p-button-outlined"
            (click)="toggleEditMode()"
            [disabled]="!project">
          </button>

          @if (isEditMode) {
            <button
              type="button"
              pButton
              label="Save"
              icon="pi pi-check"
              class="p-button-success"
              (click)="saveProject()"
              [disabled]="!isEditMode || !isFormValid()"
              >
            </button>
          }
        </div>
      </div>

      <!-- Loading State -->
      @if (!project && !error) {
        <div class="loading-state">
          <i class="pi pi-spin pi-spinner loading-icon"></i>
          <h3>Loading Project...</h3>
          <p>Please wait while we fetch the project details.</p>
        </div>
      }

      <!-- Error State -->
      @if (error) {
        <div class="error-state">
          <i class="pi pi-exclamation-triangle error-icon"></i>
          <h3>Error</h3>
          <p>{{ error }}</p>
          <button
            type="button"
            pButton
            label="Go Back"
            icon="pi pi-arrow-left"
            class="p-button-outlined"
            (click)="goBack()">
          </button>
        </div>
      }

      <!-- Project Details -->
      @if (project && !error) {
        <div class="project-card">
          <div class="card-content">
            <!-- Status Section -->
            <div class="status-section">
              <span class="status-label">Status:</span>
              <!-- View Mode -->
              @if (!isEditMode) {
                <span
                  class="status-badge"
                  [ngClass]="getStatusClass(project.status)"
                  >
                  {{ project.status }}
                </span>
              }
              <!-- Edit Mode -->
              @if (isEditMode) {
                <p-dropdown
                  [(ngModel)]="project.status"
                  [options]="statusOptions"
                  optionLabel="label"
                  optionValue="value"
                  placeholder="Select Status"
                  class="status-dropdown"
                  >
                </p-dropdown>
              }
            </div>
            <!-- Project Information Grid -->
            <div class="info-grid">
              <!-- Title -->
              <div class="info-item">
                <label class="info-label">Project Title</label>
                @if (!isEditMode) {
                  <p class="info-value">{{ project.title }}</p>
                }
                @if (isEditMode) {
                  <input
                    type="text"
                    pInputText
                    [(ngModel)]="project.title"
                    class="edit-input"
                    placeholder="Enter project title"
                    >
                }
              </div>
              <!-- Priority -->
              <div class="info-item">
                <label class="info-label">Priority</label>
                @if (!isEditMode) {
                  <p class="info-value">{{ project.priority || 'Not set' }}</p>
                }
                @if (isEditMode) {
                  <p-dropdown
                    [(ngModel)]="project.priority"
                    [options]="priorityOptions"
                    optionLabel="label"
                    optionValue="value"
                    placeholder="Select Priority"
                    >
                  </p-dropdown>
                }
              </div>
              <!-- Created Date -->
              <div class="info-item">
                <label class="info-label">Created Date</label>
                <p class="info-value">{{ formatDate(project.createdDate) }}</p>
              </div>
              <!-- Last Modified -->
              @if (project.lastModified) {
                <div class="info-item">
                  <label class="info-label">Last Modified</label>
                  <p class="info-value">{{ formatDate(project.lastModified) }}</p>
                </div>
              }
              <!-- Description -->
              <div class="info-item full-width">
                <label class="info-label">Description</label>
                @if (!isEditMode) {
                  <p class="info-value description">{{ project.description }}</p>
                }
                @if (isEditMode) {
                  <textarea
                    pInputTextarea
                    [(ngModel)]="project.description"
                    class="edit-textarea"
                    placeholder="Enter project description"
                    rows="4"
                    >
                  </textarea>
                }
              </div>
            </div>
            <!-- Action Section -->
            <div class="action-section">
              <h3>Project Actions</h3>
              <div class="action-buttons">
                <button
                  type="button"
                  pButton
                  label="View Product Backlog & Items"
                  icon="pi pi-th-large"
                  class="p-button-outlined"
                  (click)="viewProductBacklog()">
                </button>
                <button
                  type="button"
                  pButton
                  label="View Reports"
                  icon="pi pi-chart-bar"
                  class="p-button-outlined"
                  (click)="viewReports()">
                </button>
                <button
                  type="button"
                  pButton
                  label="Delete Project"
                  icon="pi pi-trash"
                  class="p-button-danger p-button-outlined"
                  (click)="deleteProject()">
                </button>
              </div>
            </div>
          </div>
        </div>
      }
    </div>
  </div>
</div>
